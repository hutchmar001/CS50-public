{% extends "layout.html" %}

{% block title %}
    Quran Results
{% endblock %}

{% block main %}
<body id="quran">

<select name="books" id="books" style="display:{{ display_select }}" onchange="location = this.value;">
    <option value="">Select...</option>
    <option value= "All">All</option>
    {% for i in result %}
        <option value= {{i}}>{{i}}</option>
    {% endfor %}
</select>
<br><br><br>

<div class="content">
    <table action="/Quran" method="get" class="table table-hover">
        <button onclick="inc(id)" style="background: crimson; display:{{ display_highlight }}">Highlight</button>
        <tbody>
            <h1>Quran</h1>
            <tr>
                <th>Number</th>
                <th>Surah</th>
           <tr>
                <td>
                    <p>{{i.num}}</p>
                </td>
                <td>
                    <p>{{i.sura}}</p>
                </td>
                <td>
                    <p>{{i.verse}}</p>
                </td>
                <td>
                    <p>{{i.text}}</p>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>             <th>Verse</th>
                <th>Text</th>
            </tr>
            {% for i in lst2 %}
    
</body>

<script>
    var search_upper = {{search_upper|tojson}};
    var search_lower = {{search_lower|tojson}};
    // Works great for passing Flask value to Javascript

    function highlight() {
        document.body.innerHTML = document.body.innerHTML.replace (new RegExp (search_upper, 'g'), "<mark>{{search_upper}}</mark>");
        document.body.innerHTML = document.body.innerHTML.replace (new RegExp (search_lower, 'g'), "<mark>{{search_lower}}</mark>");
    }

    function dehighlight() {
        document.body.innerHTML = document.body.innerHTML.replace (new RegExp (search_upper, 'g'), "<p>{{search_upper}}</p>");
        document.body.innerHTML = document.body.innerHTML.replace (new RegExp (search_lower, 'g'), "<p>{{search_lower}}</p>");

        const matches = document.querySelectorAll("mark");
        matches.forEach(mark => {
        mark.remove();
        });
        // Removes all <mark> tags
    }

    var count = 0;

    function inc(){
    count ++;
    if (count % 2 == 0) {
        dehighlight();
    } else {
        highlight();
    }
};
</script>
{% endblock %}